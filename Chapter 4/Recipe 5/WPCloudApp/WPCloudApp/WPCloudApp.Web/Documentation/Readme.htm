<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER WINDOW AND SELECT "VIEW IN BROWSER"-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <title>Windows Phone Cloud Application Project Template</title>
    <style>
        BODY            { font-family: Verdana; font-size: 67% }
        .maindiv        { background: url('Images/side-vc.gif') repeat-y; padding-left: 55px; padding-top: 5px; position: relative; height: 50px }
        P               { margin-top: 0; margin-bottom: 6px; line-height: 130% }
        H1              { margin-top: 20px; margin-bottom: 12px; font-size: 190% }
        H2              { color: #585F56; left: -55px; position: relative; margin-top: 21px; margin-bottom: 9px; font-size: 170% }
        H3              { margin-top: 21px; margin-bottom: 9px; font-size: 140%; font-weight: bold }
        H4              { margin-top: 18px; margin-bottom: 9px; font-size: 140%; font-weight: bold }
        OL              { margin-top: 0; margin-bottom: 9px; line-height: 130% }
        UL              { margin-top: 0; margin-bottom: 9px; line-height: 130% }
        LI              { margin-top: 0; margin-bottom: 6px }
        BLOCKQUOTE      { margin-left: 20px }
        TABLE           { padding: 4px; background: #f8f7ef; border: #DDDCD6 1px solid; border-collapse: collapse; margin-bottom: 9px }
        TR              { vertical-align: top }
        TD              { padding: 4px; font-family: Verdana; font-size: 67%; line-height: 130% }
        .contents       { line-height: 150% }
        DIV.CodeBlock   { font-family: "Courier New"; font-size: 100%; margin-bottom: 6px; background: #f8f7ef; border: #eeede6 1px solid; padding: 10px; }
        .CodeInline     { font-family: "Courier New" }
        .ProcedureLabel { margin-top: 12px; font-style: italic; font-weight: bold; color: #0D4CC3 }
        .FileNameCol    { padding: 6px; background: #eeede6; width: 220px; font-weight: bold }
        img.note        { border: 0; margin-right: 3; }
        span.NoteHeader { font-size: 12px; }
    </style>
</head>
<body topmargin="0" leftmargin="0" rightmargin="20">
    <div class="maindiv">
        <a name="top"></a>
        <h1>
            Windows Phone Cloud Application Project Template</h1>
        <h2>
            <a href="#top">
                <img src="Images\topjump-vc.gif" border="0"></a><a name="Introduction">Introduction</a></h2>
        <p>
            The Windows Phone Cloud Application project template for Visual Studio makes it
            easier for developers to create a Windows Phone application that relies on Windows
            Azure Storage and SQL Azure. This template generates a Windows Azure project, an ASP.NET MVC 3
            project (configured as a Web role), and a Windows Phone application project.&nbsp;
            All these projects working together show how you can interact with Azure Storage
            without needing to include the storage account information (name and key) in the
            phone application.<br />
        </p>
        <h2>
            <a href="#top">
                <img src="Images\topjump-vc.gif" border="0" /></a><a name="RunningGeneratedWindowsPhoneCloudApplication">Running
                    and Going Through the Windows Phone Cloud Application</a></h2>
        <p>After creating a new Windows Phone Cloud Application project, perform these steps to go through the sample application generated.</p>

        <div class="alert">
          <table width="100%" cellspacing="0" cellpadding="0">
            <tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr>
            <tr><td> If you face any problems while following these steps, please make sure to review the Troubleshooting section in the Toolkit Readme document.</td></tr>
          </table>
          <p />
        </div>

        <br />

        <p>
          <b>Starting the Application</b>
        </p>
        <ol>
          <li>Make sure that you do not have any Web site running in ports <b>443</b> and <b>10080</b> on your local IIS.<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td> By default, the ASP.NET MVC 3 Web role that is generated by the project template is configured to run over two different endpoints: one HTTPS in port 443 and another HTTP in port 10080.</td></tr></table><p /></div><br /></li>
          <li>Make sure that the target for <i>Silverlight for Windows Phone</i> projects is set to <b>Windows Phone Emulator</b>.<p><img src="images\Image1.png" /></p><br /></li>
          <li>In <b>Solution Explorer</b>, right-click the Windows Azure project, point to <b>Debug</b> and click <b>Start new instance</b>.</li>
          <li>Wait for the Web role to start and click the <b>Continue to this website (not recommended)</b> link to be able to browse the site despite of the certificate warning.<p>

              <img src="images\Image2b.png" />

              </p><br />
          </li>
          <li>To log into the Web application use the following credentials:<ul><li>User Name: <b>admin</b></li><li>Password:<b> </b><img src="images\Image56.png" /> (with a zero)</li></ul></li>
          <li>In <b>Solution Explorer</b>, right-click the Windows Phone project, point to <b>Debug</b> and click <b>Start new instance</b>. This will launch the Windows Phone Emulator and start the application.</li>
          <li>The application will redirect you to the <b>log in</b> page. In the <b>log in</b> page, click the <b>Install certificate</b> link. This will open Internet Explorer in the Windows Phone Emulator at <a href="http://127.0.0.1:10080/127.0.0.1.cer">http://127.0.0.1:10080/127.0.0.1.cer</a>.<p>

            <img src="images\Image4.png" />

            </p><br />
            <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">
            <img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td> In order to consume the REST services over HTTPS in a Windows Phone device or in the Windows Phone Emulator, you need to use a trusted SSL certificate. If you do not have one, you can use a self-signed certificate, but you need to install it in the phone before consuming the services.<br />Since the Computer Emulator always uses the 127.0.0.1 self-signed certificate, we need to install it in the Windows Phone Emulator before continuing with the next steps.</td></tr></table><p />
            </div><br />
          </li>
          <li>Click the shield icon to install the Compute Emulator’s certificate in the Windows Phone Emulator. Finally, click <b>install</b> to confirm that you want to install the certificate.<p><img src="images\Image5.png" /></p><br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td><b>Important:</b> If you leave the Windows Phone Emulator open, you do not need to install the certificate every time that you run the application. However, if you close the Windows Phone Emulator, you will have to install it again.</td></tr></table><p /></div><br /></li>
          <li>Once the certificate is installed, click <b>ok</b> and navigate back to the running application using the left arrow (<img src="images\Image6.png" />).<p><img src="images\Image7.png" /></p><br /></li>
        </ol>
        <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td>The menu items displayed in the Mobile Cloud Application Services Web site 
              and the pivot items shown in the phone application may differ depending on the option you selected in the template wizard steps. For example, if you selected SQL Azure Database as the <b>only</b> data provider, you will not see the Tables and Queues menu items.</td></tr></table><p /></div>

        <p>
          <b>Authenticating the user</b>
        </p>
        <ol>
          <li>In the <b>log in</b> page, a list with the configured identity providers is shown. Select the identity provider you want to authenticate with and log in providing your account information.<p><img src="images\Image9.png" /></p><br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td>Windows Live ID, Google and Yahoo identity providers are automatically configured into your ACS namespace when the application is created from the <i>Windows Phone Cloud Application</i> project template.</td></tr></table><p /></div></li>
          <br />
          <li>If this is the first time you logged into the application, you will be redirected to the <b>register</b> page. Enter a name and an email address for the user, and then click <b>register</b>. Wait for the registration to complete. If the registration was successful, you will see the <b>Registration Successful</b> message. Click <b>ok</b> and you will be redirected back to the <b>log in</b> page.<p><img src="images\Image10.png" /></p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td>In case you want to log in with different credentials, you need to log out by clicking the log out button (<img src="images\Image57.png" />) in the phone application bar, which will redirect you to the <b>log in</b> page.</td></tr></table><p /></div><br /></li>
        </ol>


        <p>
          <b>Sending Microsoft Push Notifications</b>
        </p>
        <ol>
          <li>After the user authenticates, the <b>notification</b> pivot item is shown in the application. You will notice that push notifications are not enabled and therefore the connection status is disconnected.</li>
          <li>Check the <b>Enable push notifications</b> checkbox and wait until you see a message saying that the notification updates were received.<p><img src="images\Image11.png" /></p><br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td> When the user enables push notifications, the application is registered with Microsoft Push Notification Service (MPNS) and the sample notification service included in this toolkit. After doing that, the application then downloads the queued messages for that device if there is any available.<br />For more information about MPNS, you can read the <a href="http://windowsteamblog.com/windows_phone/b/wpdev/archive/2010/05/03/understanding-microsoft-push-notifications-for-windows-phones.aspx">Understanding Microsoft Push Notifications for Windows Phones</a> and <a href="http://windowsteamblog.com/windows_phone/b/wpdev/archive/2010/05/04/understanding-how-microsoft-push-notification-works-part-2.aspx">Understanding How Microsoft Push Notification Works – Part 2</a> articles.</td></tr></table><p /></div><br /></li>
          <li>Switch to the Web browser showing the Mobile Cloud Application Services Web site. Click the <b>Log On</b> link in the top-right corner.</li>
          <li>Enter the following credentials:<ul><li>User Name: <b>admin</b></li><li>Password:<b> </b><img src="images\Image56.png" /> (with a zero)</li></ul></li>
          <li>Once logged in, additional menu options will be shown to manage user permissions to tables, blobs and queues, and to send push notifications.<p><img src="images\Image12.png" /></p><br /></li>
          <li>Click the <b>Microsoft Push Notifications</b> menu option, type <b>raw message</b> in the textbox for the user you have just created and click <b>Send Raw</b>. You will see a success message.<p><img src="images\Image13.png" /></p><br /></li>
          <li>Now, type <b>tile message</b> in the textbox and click <b>Send Tile</b>. You will see an error message saying that the notification was not received by the device.<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td> In order to receive tile notifications you need to first pin the application to the Windows Phone Start menu.</td></tr></table><p /></div><br /><p><img src="images\Image14.png" /></p><br /></li>
          <li>Switch back to the Windows Phone Emulator. You will see the raw notification message displayed in the <b>Messages</b> list.<p><img src="images\Image15.png" /></p><br /></li>
          <li>Click the windows button (<img src="images\Image16.png" />) in the Windows Phone Emulator to navigate to the Start menu. In the Start menu, click the right arrow (<img src="images\Image17.png" />) to see the entire applications’ list. In the applications’ list, click the <b>WAT Windows Phone</b> icon and hold it for a few seconds until you see a contextual menu. In the contextual menu, click <b>pin to start</b>. This will redirect you back to the Start menu and you will now see the <b>WAT Windows Phone</b> application icon.<p><img src="images\Image18.png" /></p><br /></li>
          <li>Switch to the Web browser and click <b>Send Tile</b> to send the '<b>tile message</b>' notification again. You will now see a success message.<p><img src="images\Image19.png" /></p><br /></li>
          <li>Now, type <b>toast message</b> in the textbox and click <b>Send Toast</b>. You will see another success message.<p><img src="images\Image20.png" /></p><br /></li>
          <li>Switch back to the Windows Phone Emulator. You will see that the <b>WAT Windows Phone</b> icon now displays a number (in this case <b>1</b>) and there is a toast notification available too. Click on the toast notification or the icon to open the <b>WAT Windows Phone</b> application. In the <b>notifications</b> page, you will see that both messages ('<b>tile message</b>' and '<b>toast message</b>') are displayed in the <b>Messages</b> list.<p><img src="images\Image21.png" /></p><br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td> You were not redirected to the <b>log in</b> page because the authentication token that you had received the first time you logged in, is stored by default in the Isolated Storage.</td></tr></table><p /></div></li>
          <br />
        </ol>



        <p>
          <b>Working with Tables, Blobs and Queues</b>
        </p>
        <ol>
          <li>Flick or pan to the left to navigate to the <b>tables</b> pivot item. You will see the list of available tables in your Azure storage. You can click the plus button (<img src="images\Image23.png" />) in the application bar to add a new one and click the delete button (<img src="images\Image24.png" />) next to the table’s name to delete one.<p><img src="images\Image25.png" /></p><br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td> The <i>PushUserEndpoints</i>, <i>secMembership</i> and <i>secRole</i> tables are internally used by the toolkit services. Therefore, if you try to delete one of them you will get an error message saying that you do not have permissions.</td></tr></table><p /></div><br /></li>
          <li>Flick or pan to the left to navigate to the <b>sample data</b> pivot item. You will see the rows available in the <b>SampleData</b> table. If this table does not exist in your Windows Azure Tables storage, it is first created.</li>
          <li>In the <b>sample data</b> pivot item click the plus button (<img src="images\Image23.png" />) in the application bar to add a new row. You can also click over each of the existing rows to edit or delete them.<p><img src="images\Image27.png" /></p><br /></li>
          <li>Flick or pan to the left to navigate to the <b>list blobs</b> pivot item and click the camera button (<img src="images\Image28.png" />) in the application bar. The phone’s camera will be open. Click the button in the top-right corner of the screen to take a photo and then click <b>accept</b>. This will redirect you to the <b>upload picture</b> page.<p><img src="images\Image29.png" /></p><br /></li>
          <li>In the <b>upload picture</b> page, type the name of the container where you want to upload your picture. Notice that the autocomplete list of available containers is filtered while you type. If you type a container name that does not exist in the storage, it will be created. Additionally, if you check the <b>Make container public</b> option, the <b>Container ACL</b> will be changed to <b>full public read access</b>.<p><img src="images\Image30.png" /></p><br /></li>
          <li>Type a name for the blob. Additionally, check the <b>Include location data</b> and <b>Include author data</b> options if want to include the GPS location and the user ID values as blob metadata. Finally, click <b>upload</b>. If everything worked as expected, you will see a message box saying that the image was successfully uploaded. Click <b>ok</b> to navigate back to the main pivot page.<p><img src="images\Image31.png" /></p><br /></li>
          <li>Back in the <b>list blobs</b> pivot item, chose the container where have just upload the picture in the previous step, and then click <b>list blobs</b> (notice that you can also filter the blob name by choosing a prefix).<p><img src="images\Image32.png" /></p><br /></li>
          <li>Wait until the blob list finishes loading. You should see a thumbnail of the picture you have previously uploaded along with a link to the blob. If you click the link, it will open Internet Explorer in the phone displaying the picture. Additionally, you can click the delete button (<img src="images\Image24.png" />) next to the blob’s name to delete one.<p><img src="images\Image34.png" /></p><br /></li>
          <li>Navigate back to the running application using the left arrow (<img src="images\Image6.png" />).</li>
          <li>Flick or pan to the left to navigate to the <b>queues</b> pivot item and click <b>list queues</b> to see the list of available queues in your Azure storage. Notice that you can also filter the queues using a prefix.<p><img src="images\Image33.png" /></p><br /></li>
          <li>In the <b>queues</b> pivot item, click the plus button (<img src="images\Image23.png" />) in the application bar to add a new queue (notice that you can click the delete button (<img src="images\Image24.png" />) next to the queue’s name to delete it).<p><img src="images\Image36.png" /></p><br /></li>
          <li>Click the name of the queue you have just created in the previous step to navigate to the <b>queue details</b> page.</li>
          <li>In the <b>queue details</b> page, type '<b>message 1</b>' in the textbox and click <b>queue</b>. Then type '<b>message 2</b>' in the textbox and click <b>queue</b> again. Finally, click <b>dequeue</b> two times to get the previous messages from the queue in the right order.<p><img src="images\Image37.png" /></p><br /></li>
          <li>Click the windows button (<img src="images\Image16.png" />) in the Windows Phone Emulator to navigate to the Start menu.</li>
          <li>Switch to the Web browser and click the <b>User </b>menu option. Notice that new users (like the one you have created) have by default granted permissions to access <b>Tables</b>, <b>Blobs</b> and <b>Queues</b>.<p>
 
<img src="images\Image51.png" />
 
          </p><br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="Images\note.gif" /><span class="NoteHeader">Note:</span></th></tr><tr><td>The Web Site’s administrator user (<i>admin</i>) is displayed in the list only if the application is configured to use ASP.NET Membership authentication, in which case the admin user is also a valid application user.</td></tr></table><p /></div><br /></li>
          <li>Uncheck the <b>Tables</b>, <b>Blobs</b> and <b>Queues</b> checkboxes for the user you have created.<p>
 
<img src="images\Image52.png" />
 
          </p><br /></li>
          <li>Click the <b>Tables </b>menu option. In this page, you can grant permission to each user for each of the tables available in the Windows Azure Table storage.<p><img src="images\Image41.png" /></p><br /></li>
          <li>Click the <b>Queue Permissions</b> tab. In this page, you can grant permission to each user for each of the queues available in the Windows Azure Queue storage.<p><img src="images\Image42.png" /></p><br /></li>
          <li>Click the <b>Blob Containers</b> menu option. In this page, you can grant permission to each user for each of the blob containers available in the Windows Azure Blob storage.<p><img src="images\Image48.png" /></p><br /></li>
          <li>Switch back to the Windows Phone Emulator and click the <b>WAT Windows Phone</b> icon to open the application again.</li>
          <li>Flick or pan back to left to navigate to the <b>tables list</b> pivot item and then to the <b>sample data</b> pivot item. You will see error messages in both pages saying that you have no permissions to use tables.<p><img src="images\Image43.png" /></p><br /></li>
          <li>Flick or pan to left to navigate to the <b>list blobs</b> pivot item and then click <b>list blobs</b>. You will also see an error message saying that you have no permissions to use blobs.<p><img src="images\Image44.png" /></p><br /></li>
          <li>Flick or pan to left to navigate to the <b>queues</b> pivot item and then click <b>list queues</b>. You will see an error message saying that you have no permissions to use queues.<p><img src="images\Image45.png" /></p><br /></li>
        </ol>

      
        &nbsp;<p>
            <a href="http://www.microsoft.com/info/cpyright.mspx">© Microsoft Corporation and/or
                its suppliers. All rights reserved. Terms of Use.</a>
            <p>
                <img src="Images/dpe.jpg" alt="Developer & Platform Evangelism" /></p>
            <p>
                &nbsp;</p>
    </div>
</body>
</html>
